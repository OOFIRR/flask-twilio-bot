<!DOCTYPE html>
<html>
  <body>
    <script>
      const socket = new WebSocket("wss://web-production-770fa.up.railway.app/stream");

      socket.onopen = () => {
        console.log("âœ… Connected");

        // ×©×œ×— ×”×•×“×¢×ª ×”×ª×—×œ×” ×›×ž×• ×©-Twilio ×¢×•×©×”
        socket.send(JSON.stringify({
          event: "start",
          streamSid: "test",
          start: {
            sampleRate: 8000
          }
        }));

        // ×©×œ×— ×”×•×“×¢×ª media ×ž×“×•×ž×” (base64 ×©×œ ××•×“×™×• ×¨×™×§)
        setTimeout(() => {
          const emptyAudioBase64 = btoa(String.fromCharCode(...new Uint8Array(160)));  // 20ms ×©×œ ××•×“×™×• Î¼-law ×¨×™×§
          socket.send(JSON.stringify({
            event: "media",
            streamSid: "test",
            media: {
              payload: emptyAudioBase64
            }
          }));
          console.log("ðŸ“¤ Sent mock media");
        }, 1000);
      };

      socket.onmessage = (event) => {
        console.log("ðŸ“¥ Message from server:", event.data);
      };

      socket.onerror = (e) => {
        console.error("âŒ Error", e);
      };

      socket.onclose = () => {
        console.warn("ðŸ”Œ Closed");
      };
    </script>
  </body>
</html>
